
# Excel Data Aggregator

이 Python 스크립트는 여러 Excel 시트의 데이터를 기준 시트(전체)에 자동으로 집계하고 결과를 지정된 열에 입력합니다.

---

## **1. 프로젝트 개요**

### **기능**
- **기준 시트**: `"전체"` 시트의 `C열`에 있는 값을 기준으로 탐색합니다.  
- **대상 시트**: `2번`부터 `14번`까지의 시트를 탐색합니다.  
- **대상 열**: `H~T열`에 결과를 입력합니다.
- **검색 조건**:  
  - 각 시트의 `A열` 값을 기준으로 `C열` 데이터를 가져옵니다.  
  - 일치하는 값이 없을 경우 `0`으로 처리합니다.  
- 결과는 새로운 파일 **"합산.xlsx"** 로 저장됩니다.

---

## **2. 사용 방법**

### **전제 조건**
- Python 3.x 설치
- `openpyxl` 라이브러리 설치  
  ```bash
  pip install openpyxl
  ```

### **파일 구조**
- **입력 파일**: `11월 사용량 정리.xlsx`  
- **출력 파일**: `합산.xlsx`

### **실행 절차**
1. **스크립트 실행**  
   ```bash
   python script.py
   ```
2. **파일 저장**  
   - 결과가 `"합산.xlsx"`로 저장됩니다.

---

## **3. 코드 동작 방식**

### **주요 과정**
1. **파일 불러오기**
   - `openpyxl.load_workbook`으로 엑셀 파일을 불러옵니다.

2. **기준 데이터 탐색**
   - `"전체"` 시트의 `C열` 값을 기준으로 각 시트의 `A열`에서 동일한 값을 찾습니다.

3. **값 입력**
   - 일치하는 값이 있으면 해당 행의 `C열` 값을 가져와서 `"전체"` 시트의 `H~T열`에 순서대로 입력합니다.

4. **결과 저장**
   - 최종적으로 수정된 데이터를 `"합산.xlsx"`에 저장합니다.

---

## **4. 주요 변수**

| 변수           | 설명                                       |
|----------------|--------------------------------------------|
| `file_path`    | 입력 파일 경로 (`11월 사용량 정리.xlsx`)    |
| `main_sheet`   | 기준이 되는 `"전체"` 시트                  |
| `target_sheets`| 탐색할 대상 시트 (`2~14`)                 |
| `output_columns`| 결과를 입력할 열 (`H~T`)                  |

---

## **5. 예외 처리 및 로그**

- **비어 있는 값 처리**:  
  `A열` 또는 `C열` 값이 비어있으면 `0`으로 처리합니다.
- **로그 출력**:  
   - 각 단계마다 진행 상황과 찾은 데이터를 `print`로 출력합니다.  
- **열 초과 경고**:  
   `H~T` 열 개수를 초과하면 추가 데이터는 무시합니다.

---

## **6. 파일 예시**

### **입력 파일 (`11월 사용량 정리.xlsx`)**

| C열 값 | ... |
|--------|-----|
| apple  | ... |
| banana | ... |

### **출력 파일 (`합산.xlsx`)**

| C열 값 | H열  | I열  | J열  | ... |
|--------|------|------|------|-----|
| apple  | 100  | 50   | 30   | ... |
| banana | 200  | 70   | 10   | ... |

---

## **7. 실행 로그 예시**

```plaintext
### 데이터 찾기 및 입력 시작 ###

[LOG] 'apple' 값을 찾습니다. (행: 2)
    [FOUND] 시트 '2' (행: 5)에서 '100' 값을 찾음.
    [INPUT] 'H2'에 '100' 입력.
    [FOUND] 시트 '3' (행: 3)에서 '50' 값을 찾음.
    [INPUT] 'I2'에 '50' 입력.
    ...
합산 완료 및 저장되었습니다.
```

---

## **8. 의존성**
- **openpyxl**: Excel 파일을 읽고 쓰기 위한 라이브러리.

---

## **9. 추가 사항**
- 입력 및 출력 파일 경로를 필요에 따라 수정하세요.
- 시트 이름이 `2~14` 범위를 벗어나면 스크립트를 수정해야 합니다.

---

**작성자**: Your Name  
**버전**: 1.0  
**최종 업데이트**: YYYY-MM-DD
